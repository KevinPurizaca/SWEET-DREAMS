"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[9416],{9416:(X,C,a)=>{a.r(C),a.d(C,{ComunitysModule:()=>z});var c=a(1368),g=a(4280),r=a(4716),u=a(2024),d=a(2884),p=a(6876),_=a(9280),h=a(7836),v=a(6880),t=a(2116);let R=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275mod=t.a4G({type:n});static#i=this.\u0275inj=t.s3X({providers:[c.cf],imports:[c.MD]})}return n})();var E=a(7140),I=a(1792),b=a(5352),y=a(7564),x=a(3340),G=a(920),f=a(7252),T=a(232),O=a(2736),M=a(1148),Y=a(6304),S=a(6316),D=a(3536),$=a(1864);let k=(()=>{class n{transform(e,o="dd/MM/yyyy"){return null==e||""==e?"":new c.y("en-US").transform(e,o)}static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275pipe=t.UTH({name:"DateFormatPipe",type:n,pure:!0})}return n})();function w(n,m){1&n&&(t.I0R(0,"tr")(1,"th",27),t.OEk(2,"Id"),t.C$Y(),t.I0R(3,"th",28),t.OEk(4,"Nombre"),t.C$Y(),t.I0R(5,"th",29),t.OEk(6,"Descripcion"),t.C$Y(),t.I0R(7,"th",30),t.OEk(8,"Nro Usuarios"),t.C$Y(),t.I0R(9,"th",31),t.OEk(10,"Nro Admins"),t.C$Y(),t.I0R(11,"th",32),t.OEk(12,"% Apoyo"),t.C$Y(),t.I0R(13,"th",33),t.OEk(14,"Imagen"),t.C$Y(),t.I0R(15,"th",34),t.OEk(16,"Fecha Creada"),t.C$Y(),t.I0R(17,"th",35),t.OEk(18,"Estado"),t.C$Y(),t.I0R(19,"th",36),t.OEk(20,"Acciones"),t.C$Y()())}function N(n,m){if(1&n){const e=t.KQA();t.I0R(0,"tr")(1,"td",37),t.OEk(2),t.C$Y(),t.I0R(3,"td",28),t.OEk(4),t.C$Y(),t.I0R(5,"td",29),t.OEk(6),t.C$Y(),t.I0R(7,"td",30)(8,"span",38),t.OEk(9),t.C$Y()(),t.I0R(10,"td",31)(11,"span",38),t.OEk(12),t.C$Y()(),t.I0R(13,"td",32)(14,"span",38),t.OEk(15),t.C$Y()(),t.I0R(16,"td",39)(17,"div",40),t.wR5(18,"p-image",41),t.C$Y()(),t.I0R(19,"td",34),t.OEk(20),t.wVc(21,"DateFormatPipe"),t.C$Y(),t.I0R(22,"td",35),t.OEk(23),t.C$Y(),t.I0R(24,"td",42)(25,"button",43),t.qCj("click",function(){const s=t.usT(e).$implicit,l=t.GaO();return t.CGJ(l.viewModal(2,s))}),t.C$Y(),t.I0R(26,"button",44),t.qCj("click",function(i){const l=t.usT(e).$implicit,V=t.GaO();return t.CGJ(V.deleteComunity(i,l))}),t.C$Y()()()}if(2&n){const e=m.$implicit;t.yG2(2),t.cNF(e.iid_comunity),t.yG2(2),t.cNF(e.vname_comunity),t.yG2(2),t.cNF(e.vdescription_comunity),t.yG2(3),t.cNF(e.iusers_pcomunity),t.yG2(3),t.cNF(e.iadmins_comunity),t.yG2(3),t.oRS("",e.dporcent_support," %"),t.yG2(3),t.E7m("src",e.vfirebase_url_comunity)("preview",!0),t.yG2(2),t.cNF(t.kDX(21,10,e.ddate_create)),t.yG2(3),t.cNF(e.vstate_record)}}function F(n,m){1&n&&(t.I0R(0,"tr")(1,"td",45),t.OEk(2,"No se encontr\xf3 Informaci\xf3n."),t.C$Y()())}function A(n,m){1&n&&(t.I0R(0,"tr")(1,"td",45),t.OEk(2," Cargando informaci\xf3n. Espere por favor. "),t.C$Y()())}function P(n,m){1&n&&(t.I0R(0,"small",58),t.OEk(1," Ingrese Nombre"),t.C$Y())}function L(n,m){1&n&&(t.I0R(0,"small",58),t.OEk(1,"Ingrese solo Letras"),t.C$Y())}function U(n,m){1&n&&(t.I0R(0,"small",58),t.OEk(1," Ingrese Nombre"),t.C$Y())}function j(n,m){1&n&&(t.I0R(0,"small",58),t.OEk(1,"Ingrese solo Letras"),t.C$Y())}function B(n,m){1&n&&(t.I0R(0,"small",58),t.OEk(1," Seleccion Estado."),t.C$Y())}function H(n,m){if(1&n){const e=t.KQA();t.wR5(0,"br"),t.I0R(1,"form",3)(2,"div",4)(3,"div",46)(4,"label",6),t.OEk(5,"Nombre"),t.C$Y(),t.I0R(6,"input",47),t.iHE("ngModelChange",function(i){t.usT(e);const s=t.GaO();return t.kNx(s.lsComunityDto.vname_comunity,i)||(s.lsComunityDto.vname_comunity=i),t.CGJ(i)}),t.C$Y(),t.yuY(7,P,2,0,"small",48)(8,L,2,0,"small",48),t.C$Y(),t.I0R(9,"div",49)(10,"label",6),t.OEk(11,"Descripcion"),t.C$Y(),t.I0R(12,"input",50),t.iHE("ngModelChange",function(i){t.usT(e);const s=t.GaO();return t.kNx(s.lsComunityDto.vdescription_comunity,i)||(s.lsComunityDto.vdescription_comunity=i),t.CGJ(i)}),t.C$Y(),t.yuY(13,U,2,0,"small",48)(14,j,2,0,"small",48),t.C$Y(),t.I0R(15,"div",5)(16,"label",6),t.OEk(17,"Estado"),t.C$Y(),t.I0R(18,"p-dropdown",51),t.iHE("ngModelChange",function(i){t.usT(e);const s=t.GaO();return t.kNx(s.lsComunityDto.istate_record,i)||(s.lsComunityDto.istate_record=i),t.CGJ(i)}),t.C$Y(),t.yuY(19,B,2,0,"small",48),t.C$Y(),t.I0R(20,"div",52)(21,"button",53),t.qCj("click",function(){t.usT(e);const i=t.Gew(23);return t.CGJ(i.click())}),t.C$Y(),t.I0R(22,"input",54,55),t.qCj("change",function(i){t.usT(e);const s=t.GaO();return t.CGJ(s.agregarArchivo(i))}),t.C$Y()(),t.I0R(24,"div",56),t.wR5(25,"p-image",57),t.C$Y()()()}if(2&n){const e=t.GaO();let o,i;t.yG2(),t.E7m("formGroup",e.formRegisterEdit),t.yG2(5),t.OKB("ngModel",e.lsComunityDto.vname_comunity),t.yG2(),t.E7m("ngIf",e.formRegisterEdit.controls.txtName.invalid&&e.formRegisterEdit.controls.txtName.touched),t.yG2(),t.E7m("ngIf",null==(o=e.formRegisterEdit.get("txtName"))?null:o.hasError("pattern")),t.yG2(4),t.OKB("ngModel",e.lsComunityDto.vdescription_comunity),t.yG2(),t.E7m("ngIf",e.formRegisterEdit.controls.txtDescription.invalid&&e.formRegisterEdit.controls.txtDescription.touched),t.yG2(),t.E7m("ngIf",null==(i=e.formRegisterEdit.get("txtDescription"))?null:i.hasError("pattern")),t.yG2(4),t.E7m("options",e.lstState)("emptyMessage",e.vMessageEmpty)("placeholder",e.vMessageSelect),t.OKB("ngModel",e.lsComunityDto.istate_record),t.yG2(),t.E7m("ngIf",e.formRegisterEdit.controls.intState.invalid&&e.formRegisterEdit.controls.intState.touched),t.yG2(3),t.E7m("accept",e.acceptFiles),t.yG2(3),t.E7m("src",0===e.lsComunityDto.iid_comunity||e.editImagen?e.imagenURL:e.lsComunityDto.vfirebase_url_comunity)("preview",!0)}}function J(n,m){if(1&n){const e=t.KQA();t.I0R(0,"button",59),t.qCj("click",function(){t.usT(e);const i=t.GaO();return t.CGJ(i.hideModal())}),t.C$Y(),t.I0R(1,"button",60),t.qCj("click",function(){t.usT(e);const i=t.GaO();return t.CGJ(i.saveComunity())}),t.C$Y()}if(2&n){const e=t.GaO();t.yG2(),t.E7m("loading",e.loadingSave)}}const Q=()=>({width:"600px",height:"575px"});let K=(()=>{class n{constructor(e,o,i,s,l){this.httpCoreService=i,this.commonService=s,this.confirmationService=l,this.hora="",this.paqtqtern=p.w7.Time,this.lstComunitys=[],this.uploadedFiles=[],this.totalRecord=0,this.first=0,this.rowsDefault=p.AN,this.rowsOptions=p.WA,this.vMessageEmpty=d.CM,this.vMessageSelect=d.y6,this.lstState=[],this.paramTDState=p.eE.STATES,this.editImagen=!1,this.req={iid_comunity:-1,vname_comunity:"",vdescription_comunity:"",istate_record:-1,iindex:0,ilimit:p.AN},this.titleEditRegisterComunity="",this.vmEditRegisterComunity=!1,this.submitted=!1,this.formSearch=e.group({txtName:[""],txtDescription:[""],intState:[1]}),this.formRegisterEdit=o.group({txtName:["",[r.AQ.required]],txtDescription:["",[r.AQ.required]],intState:[1,[r.AQ.required]]})}ngOnInit(){this.loadStateCB(),this.loadData(this.req)}loadData(e){this.lstComunitys=[],this.httpCoreService.post(e,u.U.GetListComunity).subscribe(o=>{o.isSuccess&&(this.lstComunitys=o.data,this.totalRecord=o.iTotal_record)})}viewModal(e,o){switch(this.uploadedFiles=[],this.lsComunityDto={},this.imagenURL=null,this.formRegisterEdit.reset(),e){case 1:this.titleEditRegisterComunity="Crear Comunidad",this.lsComunityDto.iid_comunity=0,this.vmEditRegisterComunity=!0;break;case 2:this.titleEditRegisterComunity="Editar Comunidad",this.lsComunityDto=o,this.vmEditRegisterComunity=!0}}loadStateCB(){this.httpCoreService.getDataCb(this.paramTDState).subscribe(e=>{e.isSuccess&&(this.lstState=e.data)})}saveComunity(){this.submitted=!0;let e=this.formRegisterEdit.value;for(let o in this.formRegisterEdit.controls)this.formRegisterEdit.controls[o].markAsTouched();if(this.formRegisterEdit.valid){let o={iid_comunity:this.lsComunityDto.iid_comunity,vname_comunity:e.txtName,vdescription_comunity:e.txtDescription,istate_record:e.intState,iuser_token:1};const i=new FormData;i.append("data",JSON.stringify(o)),this.uploadedFiles.forEach((s,l)=>{i.append("file",s)}),this.httpCoreService.postFromData(u.U.RegisterComunity,i).subscribe(s=>{s.isSuccess?(this.commonService.HanddleInfoMessage(d.gv.MSG_ACTUALIZADA_REGISTRADA),this.loadData(this.req),this.vmEditRegisterComunity=!1):this.commonService.HanddleErrorMessage(s)})}}agregarArchivo(e){const o=e.target.files;let i={vdescripcion_archivo_nombre:""};if(o&&o.length>0){this.editImagen=!0;const s=o[0];if(s.name.length>=p.Uv)return void this.commonService.HanddleErrorMessage("El Nombre del Archivo es muy grande.");this.uploadedFiles=[],this.imagenURL=URL.createObjectURL(s),i.vdescripcion_archivo_nombre=s.name,this.uploadedFiles.push(s)}}deleteComunity(e,o){this.confirmationService.confirm({key:"deleteDetalle",target:e.target||new EventTarget,message:d.gv.MSG_PREGUNTA_ELIMINAR,icon:"pi pi-exclamation-triangle",acceptLabel:"S\xed",accept:()=>{this.httpCoreService.delete(u.U.DeleteComunity+o.iid_comunity).subscribe(i=>{i.isSuccess?(this.commonService.HanddleInfoMessage(d.gv.MSG_ELIMINADA),this.loadData(this.req)):this.commonService.HanddleErrorMessage(i)})},reject:()=>{}})}hideModal(){this.editImagen=!1,this.uploadedFiles=[],this.lsComunityDto={},this.vmEditRegisterComunity=!1}static#t=this.\u0275fac=function(o){return new(o||n)(t.GI1(r.im),t.GI1(r.im),t.GI1(I.c),t.GI1(b.G),t.GI1(y.EV))};static#e=this.\u0275cmp=t.In1({type:n,selectors:[["app-comunitys"]],standalone:!0,features:[t.UHJ],decls:35,vars:20,consts:[["key","deleteDetalle"],["key","tst",3,"baseZIndex"],["header","Busqueda de Comunidades"],[3,"formGroup"],[1,"grid","p-formgrid","p-fluid"],[1,"col-12","md:col-3"],[1,"label-filter-text"],["formControlName","txtName","type","text","pInputText","",1,"p-inputtext","p-component","p-element"],["formControlName","txtDescription","type","text","pInputText","",1,"p-inputtext","p-component","p-element"],["formControlName","intState","optionLabel","vvalue1","optionValue","id","appendTo","body",3,"placeholder","emptyMessage","options"],[1,"flex","flex-wrap","sm:flex-row"],[1,"sm:mr-auto","mb-3","mr-3"],["pButton","","label","Agregar Comunidad","type","button","icon","pi pi-plus",1,"p-button-help",3,"click"],[1,"mb-3","mr-3"],["pButton","","label","Buscar","icon","pi pi-search","type","submit",1,"p-button-outlined","p-button-primary"],[1,""],["pButton","","label","Limpiar","type","button","icon","pi pi-trash",1,"p-button-outlined","p-button-secondary",3,"click"],["header","Resultado de Comunidades"],["scrollDirection","both","scrollHeight","400px","styleClass","mt-3","styleClass","p-datatable-gridlines","responsiveLayout","scroll",3,"value","scrollable"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","loadingbody"],["currentPageReportTemplate","Total : {totalRecords} registros",3,"rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","first"],[3,"visible","draggable","closable","header","modal","visibleChange"],["pTemplate","content"],["pTemplate","footer"],[1,"td-id"],[1,"td-name"],[1,"td-description"],[1,"td-number-users"],[1,"td-number-admins"],[1,"td-percent-support"],[1,"td-image"],[1,"td-date-create"],[1,"td-state"],["pFrozenColumn","","alignFrozen","right",1,"td-actions"],[1,"td-id","font-bold"],[1,"flex","justify-content-end"],[1,"td-image","p-1","m-0"],[1,"flex","justify-content-center","p-0","m-0"],["alt","Image","appendTo","body","width","50",1,"p-0","m-0",3,"src","preview"],["pFrozenColumn","","alignFrozen","right",1,"font-bold"],["pButton","","icon","pi pi-pencil","pTooltip","Editar","tooltipPosition","bottom",1,"text-green-500","p-button-text",3,"click"],["pButton","","icon","pi pi-trash","pTooltip","Eliminar","tooltipPosition","bottom",1,"text-red-500","p-button-text",3,"click"],["colspan","7"],[1,"col-12","md:col-4"],["formControlName","txtName","type","text","pInputText","",1,"p-inputtext","p-component","p-element",3,"ngModel","ngModelChange"],["class","text-red-600",4,"ngIf"],[1,"col-12","md:col-5"],["formControlName","txtDescription","type","text","pInputText","",1,"p-inputtext","p-component","p-element",3,"ngModel","ngModelChange"],["formControlName","intState","optionLabel","vvalue1","optionValue","id","appendTo","body",3,"options","emptyMessage","placeholder","ngModel","ngModelChange"],[1,"col-12","md:col-12"],["pButton","","pRipple","","label","Seleccionar Imagen","icon","pi pi-image",1,"shadow-2","hover:shadow-8","h-3rem","w-13rem","p-button-info",3,"click"],["type","file",2,"display","none",3,"accept","change"],["fileInput2",""],[1,"col-12","md:col-12","flex","justify-content-center"],["alt","Image","appendTo","body","width","235",3,"src","preview"],[1,"text-red-600"],["pButton","","pRipple","","label","Cerrar","icon","pi pi-times",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Guardar","icon","pi pi-save",1,"p-button-text",3,"loading","click"]],template:function(o,i){1&o&&(t.wR5(0,"p-confirmPopup",0)(1,"p-toast",1),t.I0R(2,"p-panel",2)(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),t.OEk(7,"Nombre"),t.C$Y(),t.wR5(8,"input",7),t.C$Y(),t.I0R(9,"div",5)(10,"label",6),t.OEk(11,"Descripcion"),t.C$Y(),t.wR5(12,"input",8),t.C$Y(),t.I0R(13,"div",5)(14,"label",6),t.OEk(15,"Estado"),t.C$Y(),t.wR5(16,"p-dropdown",9),t.C$Y()(),t.I0R(17,"div",10)(18,"div",11)(19,"button",12),t.qCj("click",function(){return i.viewModal(1,null)}),t.C$Y()(),t.I0R(20,"div",13),t.wR5(21,"button",14),t.C$Y(),t.I0R(22,"div",15)(23,"button",16),t.qCj("click",function(){return i.formSearch.reset()}),t.C$Y()()()()(),t.wR5(24,"br"),t.I0R(25,"p-panel",17)(26,"p-table",18),t.yuY(27,w,21,0,"ng-template",19)(28,N,27,12,"ng-template",20)(29,F,3,0,"ng-template",21)(30,A,3,0,"ng-template",22),t.C$Y(),t.wR5(31,"p-paginator",23),t.C$Y(),t.I0R(32,"p-dialog",24),t.iHE("visibleChange",function(l){return t.kNx(i.vmEditRegisterComunity,l)||(i.vmEditRegisterComunity=l),l}),t.yuY(33,H,26,15,"ng-template",25)(34,J,2,1,"ng-template",26),t.C$Y()),2&o&&(t.yG2(),t.E7m("baseZIndex",99999),t.yG2(2),t.E7m("formGroup",i.formSearch),t.yG2(13),t.E7m("placeholder",i.vMessageSelect)("emptyMessage",i.vMessageEmpty)("options",i.lstState),t.yG2(10),t.E7m("value",i.lstComunitys)("scrollable",!0),t.yG2(5),t.E7m("rows",i.req.ilimit)("totalRecords",i.totalRecord)("rowsPerPageOptions",i.rowsOptions)("showCurrentPageReport",!0)("first",i.first),t.yG2(),t.m_g(t.q4q(19,Q)),t.OKB("visible",i.vmEditRegisterComunity),t.E7m("draggable",!1)("closable",!1)("header",i.titleEditRegisterComunity)("modal",!0))},dependencies:[_.k,c.u_,r.sz,r.ot,r.ue,r.u,r.uW,r.Wo,x.o,G.cS,y.U3,f.oJ,f._E,T.A9,O.C,M.s,Y.qA,S.C,D.W,$._,h.U,h.W,v.W,R,k,E.sZ],styles:[".td-id[_ngcontent-%COMP%]{min-width:3rem;max-width:3rem}.td-name[_ngcontent-%COMP%]{min-width:15rem;max-width:15rem}.td-description[_ngcontent-%COMP%]{min-width:18rem;max-width:18rem}.td-number-users[_ngcontent-%COMP%], .td-number-admins[_ngcontent-%COMP%]{min-width:8rem;max-width:8rem}.td-percent-support[_ngcontent-%COMP%]{min-width:10rem;max-width:10rem}.td-image[_ngcontent-%COMP%]{min-width:8rem;max-width:8rem}.td-date-create[_ngcontent-%COMP%]{min-width:9rem;max-width:9rem}.td-state[_ngcontent-%COMP%], .td-actions[_ngcontent-%COMP%]{min-width:8rem;max-width:8rem}"]})}return n})(),W=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275mod=t.a4G({type:n});static#i=this.\u0275inj=t.s3X({imports:[g.qQ.forChild([{path:"",component:K}]),g.qQ]})}return n})(),z=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275mod=t.a4G({type:n});static#i=this.\u0275inj=t.s3X({imports:[c.MD,W]})}return n})()}}]);